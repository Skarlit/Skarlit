webpackJsonp([0],[function(e,t,i){e.exports=i(1)},function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),r=i(2),l=i(3),o=a(l),h=i(154),u=a(h),d={toolBarView:null,screenView:null,toolBarState:{imageUrl:"../../../img/miku.jpg",threshold:10},update:function(){this.toolBarView.setState(d.toolBarState),this.screenView.setState(d.toolBarState)}},c=o["default"].createClass({displayName:"App",render:function(){return o["default"].createElement("div",{className:"panel"},o["default"].createElement("div",{className:"heading"},o["default"].createElement("span",{className:"title"},"Magic Wand v0.01")),o["default"].createElement("div",{className:"content"},o["default"].createElement("div",{style:{fontSize:"14px",textAlign:"center",margin:"10px auto"}},"Defect: I have yet to figure out a way to reduce and smooth the edges of selection. (this is also highly UNoptimized)"),this.props.children))}}),f=o["default"].createClass({displayName:"ToolBar",getInitialState:function(){return d.toolBarState},componentDidMount:function(){d.toolBarView=this},thresholdChange:function(e){d.toolBarState.threshold=e.target.value,d.update()},setImageUrl:function(){d.toolBarState.imageUrl=this.refs.imageUrl.getDOMNode().value,d.update()},render:function(){return o["default"].createElement("div",{className:"toolbar"},o["default"].createElement("div",{className:"threshold"},o["default"].createElement("span",null,"Threshold: "),o["default"].createElement("div",{className:"input-control range"},o["default"].createElement("input",{type:"range",onInput:this.thresholdChange,defaultValue:this.state.threshold,min:1,max:16,step:.1})),o["default"].createElement("span",null,this.state.threshold)))}}),g=o["default"].createClass({displayName:"Screen",getInitialState:function(){return{imageUrl:d.toolBarState.imageUrl}},shouldComponentUpdate:function(e,t){return this.state.imageUrl!=t.imageUrl},componentDidMount:function(){d.screenView=this,this.wand=new m(this.state.imageUrl,this.refs.image.getDOMNode(),this.refs.overlay.getDOMNode(),this.refs.screen.getDOMNode())},componentDidUpdate:function(){this.wand.destroy(),this.wand=null,this.wand=new m(this.state.imageUrl,this.refs.image.getDOMNode(),this.refs.overlay.getDOMNode(),this.refs.screen.getDOMNode())},render:function(){return o["default"].createElement("div",{className:"screen",ref:"screen"},o["default"].createElement("canvas",{ref:"image",style:{zIndex:10},width:800,height:600}),o["default"].createElement("canvas",{ref:"overlay",style:{zIndex:100,backgroundColor:"rgba(0,0,0,0)"},width:800,height:600}),o["default"].createElement("div",{className:"hud"}," "))}}),m=function(){function e(t,i,a,s){n(this,e),this.image=i,this.overlay=a,this.screen=s,this.imgCtx=i.getContext("2d"),this.overlayCtx=a.getContext("2d"),this.load(t),this.bindEvents(),this.hud=s.getElementsByClassName("hud")[0]}return s(e,[{key:"destroy",value:function(){u["default"](this.overlay).off("click"),u["default"](this.overlay).off("mousemove"),this.image=null,this.overlay=null,this.screen=null,this.imgCtx=null,this.overlayCtx=null,this.graph=null}},{key:"bindEvents",value:function(){u["default"](this.overlay).on("click",function(e){var t=this.overlay.getBoundingClientRect();this.drawOverLay(this.dfs(parseInt(e.clientX-t.left)+parseInt(e.clientY-t.top)*this.w))}.bind(this)),u["default"](this.overlay).on("mousemove",function(e){var t=this.overlay.getBoundingClientRect(),i=parseInt(e.clientX-t.left),a=parseInt(e.clientY-t.top),n=4*(i+a*this.w);this.hud.textContent="("+i+","+a+") rgb("+[this.pixels[n],this.pixels[n+1],this.pixels[n+2]].join(",")+")"}.bind(this))}},{key:"load",value:function(e){var t=new Image;t.onload=function(){this.drawImage(t),this.buildGraph()}.bind(this),t.src=e}},{key:"drawImage",value:function(e){this.resize(e.width,e.height),this.imgCtx.drawImage(e,0,0),this.pixels=this.imgCtx.getImageData(0,0,this.image.width,this.image.height).data}},{key:"drawOverLay",value:function(e){this.overlayCtx.clearRect(0,0,this.w,this.h),this.overlayCtx.fillStyle="red";for(var t=Object.keys(e.border),i=0;i<t.length;i++)this.overlayCtx.fillRect(t[i]%this.w+.5,t[i]/this.w+.5,2,2)}},{key:"_overlayAnimateLoop",value:function(){}},{key:"resize",value:function(e,t){this.overlay.width=e,this.image.width=e,this.screen.style.width=e+"px",this.overlay.height=t,this.image.height=t,this.screen.style.height=t+"px",this.w=e,this.h=t}},{key:"buildGraph",value:function(){this.graph=new r.DiGraph(this.w*this.h);for(var e,t=1;t<this.h-1;t++)for(var i=1;i<this.w-1;i++)e=i+t*this.w,this.graph.addEdge(e,e+1),this.graph.addEdge(e,e-1),this.graph.addEdge(e,e-this.w),this.graph.addEdge(e,e+this.w)}},{key:"dist",value:function(e,t){var i=[this.pixels[e],this.pixels[e+1],this.pixels[e+2]],a=[this.pixels[t],this.pixels[t+1],this.pixels[t+2]];return Math.pow(i[0]-a[0],2)+Math.pow(i[1]-a[1],2)+Math.pow(i[2]-a[2],2)}},{key:"dfs",value:function(e){for(var t,i,a=[e],n={},s={},r={},l=d.toolBarState.threshold;a.length>0;){t=a.pop(),n[t]=!0,i=this.graph.adj(t);for(var o=0;o<i.length;o++)this.dist(4*t,4*i[o])<l*l?(n[i[o]]||a.push(i[o]),r[i[o]]=!0):s[i[o]]=!0}return{border:s,interior:r}}}]),e}();window.onload=function(){o["default"].render(o["default"].createElement(c,null,o["default"].createElement(f,null),o["default"].createElement(g,null)),document.body)}},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),n=function(){function e(t){i(this,e),this.adjList=new Array(t);for(var a=0;t>a;a++)this.adjList[a]=[];this.vertices=t,this.edge=0}return a(e,[{key:"v",value:function(){return this.vertices}},{key:"e",value:function(){return this.edge}},{key:"addEdge",value:function(e,t){this.adjList[e].push(t),this.edge++}},{key:"adj",value:function(e){return this.adjList[e]}}]),e}();t.DiGraph=n}]);